---
title: SQL 최적화의 기본 원리(옵티마이저와 실행계획/인덱스/조인수행원리)
date: 2020-07-03 12:07:16
layout: post
draft: false
path: "/cs/db-sql/optimization/"
category: "DB&SQL"
tags:
- "database"
description: "SQL 최적화의 기본 원리에 대해서 알아봅시다."
---

## 1. 옵티마이저와 실행계획

### 1-1. 옵티마이저

- 옵티마이저는 사용자가 질의한 SQL문에 대해 최적의 실행 방법을 결정하는 역할을 한다.
- 이를 통해 개발자가 SQL이 동작하는 과정을 직접 코딩 할 필요가 없어졌다.
- 이전에는 테이블을 기준 테이블을 select하고 fetch하고, 반대편 테이블에서 조인 레코드를
seek하는 과정을 loop하는 이 과정을 직접 개발했어야했다.
- DBMS의 핵심기능이다.

#### 옵티마이저의 최적화 수행 단계를 요약하면 아래와 같다.

1. 사용자가 던진 쿼리 수행을 위해 후보군이 될만한 실행계획들을 찾아냄
2. 데이터 딕셔너리에 미리 수집해 놓은 오브젝트 통계 및 시스템 통계정보를 이용해
각 실행 단계의 예상비용을 산정
3. 각 실행계획의 비용을 비교해서 최소비용을 갖는 하나를 선택

### 1-2. 실행 계획(Execution Plan)

- **조인순서**: 논리적으로 가능한 순서는 n! 개
- **조인 기법**: NL Join / Hash Join / Sort Merge Join
- **액세스 기법**: 인덱스 스캔 / 전체 테이블 스캔
- **최적화 정보**: 비용기반최적화-Cost / Card / Bytes (통계정보를 바탕으로 한 예상치)
- **연산** : 조인기법, 액세스기법, 필터, 정렬(order by), 집계, 뷰 등 다양함

## 2. 인덱스

- **목적**: 검색 성능의 최적화
- 인덱스는 테이블을 기반으로 선택적으로 생성할 수 있는 구조
- 인덱스는 데이블에 생성하지 않아도 되고 여러 개 생성해도 된다.
- 인덱스 칼럼 순서는 질의 성능에 중요한 영향을 미치는 요소이다.
- 트리기반 인덱스에는 B-트리 인덱스, 비트맵 인덱스, 리버스 키 인덱스. 함수기반 인덱스 등 존재한다

## 3. 조인수행원리

- 두 개 이상의 테이블을 하나의 집합으로 만드는 연산을 조인이라고 한다.
- FROM절에 두 개 이상의 테이블이 나열된 경우 조인이 수행된다.
- 조인 단계별로 다른 조인 기법을 사용할 수 있다.

---

ref: [SQL 최적화 기본원리 : 옵티마이저와 실행계획 / 인덱스 / 조인수행원리](https://m.blog.naver.com/0325han/221225506802)<br>
ref: [DBMS 아키텍처](https://cornswrold.tistory.com/120)<br>
ref: [SQL 파싱 처리 과정과 성능 향상 포인트 최적화!](https://jeong-pro.tistory.com/157)
